--// Variables
local Player = game.Players.LocalPlayer
local Teleporting = false

--// Functions
local function WaitTill(instance, Text)
    repeat task.wait() until (instance.Text == Text and Player.PlayerGui.HUD.Bottom.ChatGui.Visible == true)
end

local function Talk(NPC, Content, WaitTime, Texts, WaitForText)
    if not Player.Backpack:FindFirstChild("ServerTraits") then
        Player.Backpack:WaitForChild("ServerTraits", 30)
    end

    -- Start chat
    Player.Backpack.ServerTraits.ChatStart:FireServer(workspace.FriendlyNPCs[NPC])

    for i = 1, #Content do
        if WaitForText then
            WaitTill(Player.PlayerGui.HUD.Bottom.ChatGui.TextLabel, Texts[i])
            task.wait(WaitTime)
        else
            task.wait(WaitTime + 0.25)
        end

        Player.Backpack.ServerTraits.ChatAdvance:FireServer({Content[i]})
    end
end

-- Function to check if Jiren is dead
local function IsJirenDead()
    local jiren = workspace.Live:FindFirstChild("Jiren")
    return jiren == nil or (jiren and jiren:FindFirstChild("Humanoid") and jiren.Humanoid.Health <= 0)
end

-- Function to talk to Zeno after Jiren is dead
local function TalkToZeno()
    if IsJirenDead() then
        print("Jiren is dead, talking to Zeno...")
        
        Talk(
            "Zeno", -- NPC Name
            {"Sugoi ne. Now you can get a prize with the super dragon balls!"}, -- First message
            1, -- Wait time between messages
            {"Sugoi ne. Now you can get a prize with the super dragon balls!"}, -- Text to wait for
            true -- Wait for text
        )

        -- Wait for the second prompt and respond
        Talk(
            "Zeno", -- NPC Name
            {"100k Zenni"}, -- Choose the 100k Zenni option
            1, -- Wait time between responses
            {"What are you gonna pick? Prestige your character? Remove the level cap? or get the max zenni?"}, -- Text to wait for
            true -- Wait for text
        )

        print("Finished talking to Zeno.")
        -- After talking to Zeno, teleport to a new place (Place ID: 536102540)
        game:GetService("TeleportService"):Teleport(536102540, game.Players.LocalPlayer)
    else
        print("Jiren is not dead yet. Retrying...")
    end
end

-- Continuous attempt to talk to Zeno
task.spawn(function()
    while true do
        TalkToZeno()  -- Try talking to Zeno
        task.wait(5)  -- Wait 5 seconds before checking again
    end
end)
